<!-- Content -->
<div class="content container-fluid">
  <div class="row justify-content-lg-center">
    <div class="col-lg-10">
      <!-- Profile Cover -->
      <div class="profile-cover">
        <div class="profile-cover-img-wrapper">
          <img class="profile-cover-img" src="./assets/img/1920x400/img1.jpg" alt="Image Description">
        </div>
      </div>
      <!-- End Profile Cover -->

      <!-- Profile Header -->
      <div class="text-center mb-5">
        <!-- Avatar -->
        <div class="avatar avatar-xxl avatar-circle profile-cover-avatar">
          <img class="avatar-img"
            [src]="customer?.img ? imagePath + customer?.img : '../../../assets/img/160x160/img1.jpg'"
            onerror="this.src='../../../assets/img/160x160/img1.jpg'" alt="{{customer?.firstName}}">
          <span class="avatar-status avatar-status-success"></span>
        </div>
        <!-- End Avatar -->

        <!-- {{(customer.firstName?.concat(' ').concat(customer.lastName) | titlecase) }} -->
        <h1 class="page-header-title">{{(customer?.firstName?.concat(' ').concat(customer?.lastName) | titlecase) }}<i
            class="bi-patch-check-fill fs-2 text-primary" data-bs-toggle="tooltip" data-bs-placement="top"
            title="Active User"></i></h1>

        <!-- List -->
        <ul class="list-inline list-px-2">
          <li class="list-inline-item">
            <i class="bi-building me-1"></i>
            <span>{{customer?.account_num}} </span>
          </li>

          <li class="list-inline-item">
            <i class="bi-geo-alt me-1"></i>
            <a href="javascript:;">{{customer?.state ? customer?.state + ', ': 'Lagos, ' }}</a>
            <a href="javascript:;">{{customer?.country ? customer?.country+ '.': 'Nigeria.'}}</a>
          </li>

          <li class="list-inline-item">
            <i class="bi-calendar-week me-1"></i>
            <span>Joined {{customer?.dateCreated | date: 'MMMM yyyy'}}</span>
          </li>
        </ul>
        <!-- End List -->
      </div>
      <!-- End Profile Header -->

      <!-- Nav -->
      <div class="js-nav-scroller hs-nav-scroller-horizontal mb-5">

        <span class="hs-nav-scroller-arrow-prev" style="display: none;">
          <a class="hs-nav-scroller-arrow-link" href="javascript:;">
            <i class="bi-chevron-left"></i>
          </a>
        </span>

        <span class="hs-nav-scroller-arrow-next" style="display: none;">
          <a class="hs-nav-scroller-arrow-link" href="javascript:;">
            <i class="bi-chevron-right"></i>
          </a>
        </span>

        <ul class="nav nav-tabs align-items-center">
          <li class="nav-item">
            <a class="nav-link active" id="profile-tab" data-bs-toggle="tab" href="#profile" role="tab">Profile</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" id="savings-tab" data-bs-toggle="tab" href="#savings" role="tab">Savings</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" id="withdrawal-tab" data-bs-toggle="tab" href="#withdrawal" role="tab">Withdraw</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" id="transactions-history-tab" data-bs-toggle="tab" href="#transactions-history"
              role="tab">Transactions
              <span class="badge bg-soft-dark text-dark rounded-circle ms-1">{{customerTrxs ? customerTrxs?.length: 0
                }}</span>
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" id="plans-tab" data-bs-toggle="tab" href="#plans" role="tab">Plans</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" id="updateProfile-tab" data-bs-toggle="tab" href="#updateProfile" role="tab">Update Profile</a>
          </li>

          <li class="nav-item ms-auto">
            <div class="d-flex gap-2">
              <!-- Form Check -->
              <div class="form-check form-check-switch">
                <input class="form-check-input" type="checkbox" value="" id="connectCheckbox">
                <label class="form-check-label btn-sm" for="connectCheckbox">
                  <span class="form-check-default">
                    <i class="bi-person-plus-fill"></i> Connect
                  </span>
                  <span class="form-check-active">
                    <i class="bi-check-lg me-2"></i> Connected
                  </span>
                </label>
              </div>
              <!-- End Form Check -->

              <!-- Dropdown -->
              <div class="dropdown nav-scroller-dropdown">
                <button type="button" class="btn btn-white btn-icon btn-sm" id="profileDropdown"
                  data-bs-toggle="dropdown" aria-expanded="false">
                  <i class="bi-three-dots-vertical"></i>
                </button>

                <div class="dropdown-menu dropdown-menu-end mt-1" aria-labelledby="profileDropdown">
                  <span class="dropdown-header">Contact</span>

                  <a class="dropdown-item" href="tel:{{customer?.userId}}">
                    <i class="bi-share-fill dropdown-item-icon"></i> Contact Phone
                  </a>
                  <a class="dropdown-item" href="mailto:{{customer?.email}}">
                    <i class="bi-slash-circle dropdown-item-icon"></i> Send Email
                  </a>
                  <a class="dropdown-item" target="_blank"
                    href="https://api.whatsapp.com/send/?phone=234{{customer?.userId}}&text=Hello+{{customer?.firstName}}">
                    <i class="bi-info-circle dropdown-item-icon"></i> Contact Whatsapp
                  </a>

                  <div class="dropdown-divider"></div>

                  <span class="dropdown-header">Feedback</span>

                  <a class="dropdown-item" href="javascript:;">
                    <i class="bi-flag dropdown-item-icon"></i> Report
                  </a>
                </div>
              </div>
              <!-- End Dropdown -->
            </div>
          </li>
        </ul>
      </div>
      <!-- End Nav -->
      <div class="tab-content" id="DetailsPageTabContent">
        <div class="tab-pane fade show active" id="profile" role="tabpanel" aria-labelledby="profile-tab">

          <div class="row">
            <div class="col-lg-4">
              <!-- Card -->
              <div class="card card-body mb-3 mb-lg-5" *ngFor="let plan of userPlans; let i = index;">
                <div class="d-flex">
                  <h5>{{plan.plan_name}}</h5>
                  <h5 [ngClass]="roundNumber(changeNumber(plan?.ledger_bal) / (30 * changeNumber(plan?.plan_amount)) * 100) >= 50 
                     ? 'ms-auto text-success ' : 'ms-auto text-danger' ">Bal: {{plan.available_bal | currency: '₦'}}
                  </h5>
                </div>

                <!-- Progress -->
                <div class="d-flex justify-content-between align-items-center">
                  <div class="progress flex-grow-1">
                    <div class="progress-bar bg-primary" role="progressbar"
                      [ngStyle]="{'width': roundNumber(changeNumber(plan?.ledger_bal) / (30 * changeNumber(plan?.plan_amount)) * 100) +'%'}"
                      attr.aria-valuenow="{{roundNumber(changeNumber(plan?.ledger_bal) / (30 * changeNumber(plan?.plan_amount)) * 100)}}"
                      aria-valuemin="0" aria-valuemax="100"></div>
                  </div>
                  <span class="ms-4">{{plan?.ledger_bal > 0 ? roundNumber(changeNumber(plan?.ledger_bal) / (30 *
                    changeNumber(plan?.plan_amount)) * 100) : 0}}%</span>
                </div>
                <!-- End Progress -->
              </div>
              <!-- End Card -->



              <!-- Sticky Block Start Point -->
              <div id="accountSidebarNav"></div>

              <!-- Card -->
              <div class="js-sticky-block card mb-3 mb-lg-5" data-hs-sticky-block-options='{
                     "parentSelector": "#accountSidebarNav",
                     "breakpoint": "lg",
                     "startPoint": "#accountSidebarNav",
                     "endPoint": "#stickyBlockEndPoint",
                     "stickyOffsetTop": 20
                   }'>
                <!-- Header -->
                <div class="card-header">
                  <h4 class="card-header-title">Profile</h4>
                </div>
                <!-- End Header -->

                <!-- Body -->
                <div class="card-body">
                  <ul class="list-unstyled list-py-2 text-dark mb-0">
                    <li class="pb-0"><span class="card-subtitle">About</span></li>
                    <li><i class="bi-person dropdown-item-icon"></i> {{customer?.firstName | titlecase}}
                      {{customer?.lastName | titlecase}}</li>
                    <li><i class="bi-building dropdown-item-icon"></i> {{customer?.gender}}</li>

                    <li class="pt-4 pb-0"><span class="card-subtitle">Account</span></li>
                    <li><i class="bi-briefcase dropdown-item-icon"></i> {{customer?.account_num}}</li>
                    <li><i class="bi-briefcase dropdown-item-icon"></i> {{customer?.BVN_num}}</li>

                    <li class="pt-4 pb-0"><span class="card-subtitle">Contacts</span></li>
                    <li><i class="bi-at dropdown-item-icon"></i> {{customer?.email}} </li>
                    <li><i class="bi-phone dropdown-item-icon"></i> {{customer?.userId}}</li>

                    <li class="pt-4 pb-0"><span class="card-subtitle">Address</span></li>
                    <li *ngIf="customer?.address"><i class="bi-house dropdown-item-icon"></i> {{customer?.address}}</li>
                    <li *ngIf="customer?.city"><i class="bi-house-door dropdown-item-icon"></i> {{customer?.city}}</li>
                    <li *ngIf="customer?.state"><i class="bi-house dropdown-item-icon"></i> {{customer?.state}}</li>
                    <li *ngIf="customer?.country"><i class="bi-house-door dropdown-item-icon"></i> {{customer?.country}}
                    </li>
                  </ul>
                </div>
                <!-- End Body -->
              </div>
              <!-- End Card -->
            </div>

            <div class="col-lg-8">
              <div class="d-grid gap-3 gap-lg-5">
                <!-- Card -->
                <div class="card">
                  <!-- Header -->
                  <div class="card-header card-header-content-between">
                    <h4 class="card-header-title">Activity stream</h4>

                    <!-- Dropdown -->
                    <div class="dropdown">
                      <button type="button" class="btn btn-ghost-secondary btn-icon btn-sm rounded-circle"
                        id="contentActivityStreamDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                        <i class="bi-three-dots-vertical"></i>
                      </button>

                      <div class="dropdown-menu dropdown-menu-end mt-1" aria-labelledby="contentActivityStreamDropdown">
                        <span class="dropdown-header">Settings</span>

                        <a class="dropdown-item" href="javascript:;">
                          <i class="bi-share-fill dropdown-item-icon"></i> Share connections
                        </a>
                        <a class="dropdown-item" href="javascript:;">
                          <i class="bi-info-circle dropdown-item-icon"></i> Suggest edits
                        </a>

                        <div class="dropdown-divider"></div>

                        <span class="dropdown-header">Feedback</span>

                        <a class="dropdown-item" href="javascript:;">
                          <i class="bi-chat-left-dots dropdown-item-icon"></i> Report
                        </a>
                      </div>
                    </div>
                    <!-- End Dropdown -->
                  </div>
                  <!-- End Header -->

                  <!-- Body -->
                  <div class="card-body card-body-height" style="height: 30rem;">
                    <!-- Step -->
                    <ul class="step step-icon-xs mb-0">

                      <!-- Step Item -->
                      <li class="step-item">
                        <div class="step-content-wrapper">
                          <span class="step-icon step-icon-pseudo step-icon-soft-dark"></span>

                          <div class="step-content">
                            <h5 class="step-title">
                              <a class="text-dark" href="javascript:;">Customer plan completed </a>
                            </h5>

                            <p class="fs-5 mb-1">Marked as <span
                                class="badge bg-soft-success text-success rounded-pill"><span
                                  class="legend-indicator bg-success"></span>"Completed"</span></p>

                            <span class="text-muted small text-uppercase">Today</span>
                          </div>
                        </div>
                      </li>
                      <!-- End Step Item -->

                      <!-- Step Item -->
                      <li class="step-item">
                        <div class="step-content-wrapper">
                          <span class="step-icon step-icon-pseudo step-icon-soft-dark"></span>

                          <div class="step-content">
                            <h5 class="step-title">
                              <a class="text-dark" href="javascript:;">MoCustomer saves 200.00 to starter plan</a>
                            </h5>

                            <p class="fs-5 mb-1">Agent Dele performs the transaction</p>

                            <span class="text-muted small text-uppercase">May 10</span>
                          </div>
                        </div>
                      </li>
                      <!-- End Step Item -->



                      <!-- Step Item -->
                      <li class="step-item">
                        <div class="step-content-wrapper">
                          <span class="step-icon step-icon-pseudo step-icon-soft-dark"></span>

                          <div class="step-content">
                            <h5 class="step-title">
                              <a class="text-dark" href="javascript:;">MoCustomer starts saving</a>
                            </h5>

                            <p class="fs-5 mb-1">Agent Sola collects the money</p>

                            <span class="text-muted small text-uppercase">May 10</span>
                          </div>
                        </div>
                      </li>
                      <!-- End Step Item -->

                      <!-- Step Item -->
                      <li class="step-item">
                        <div class="step-content-wrapper">
                          <span class="step-icon step-icon-pseudo step-icon-soft-dark"></span>

                          <div class="step-content">
                            <h5 class="step-title">
                              <a class="text-dark" href="javascript:;">MoCustomer subscribed to a starter plan</a>
                            </h5>

                            <p class="fs-5 mb-1">Marked as <span
                                class="badge bg-soft-primary text-primary rounded-pill"><span
                                  class="legend-indicator bg-primary"></span>"In progress"</span></p>

                            <span class="text-muted small text-uppercase">Apr 29</span>
                          </div>
                        </div>
                      </li>
                      <!-- End Step Item -->

                      <!-- Step Item -->
                      <li class="step-item">
                        <div class="step-content-wrapper">
                          <span class="step-icon step-icon-pseudo step-icon-soft-dark"></span>

                          <div class="step-content">
                            <h5 class="step-title">
                              <a class="text-dark" href="javascript:;">Onboarding</a>
                            </h5>

                            <p class="fs-5 mb-1">The customer registers on moloyal <i
                                class="tio-verified text-primary"></i> badge</p>

                            <span class="text-muted small text-uppercase">Apr 06</span>
                          </div>
                        </div>
                      </li>
                      <!-- End Step Item -->



                      <!-- Step Item -->
                      <li id="collapseActivitySection" class="step-item collapse">
                        <div class="step-content-wrapper">
                          <span class="step-icon step-icon-pseudo step-icon-soft-dark"></span>

                          <div class="step-content">
                            <h5 class="step-title">
                              <a class="text-dark" href="javascript:;">Project status updated</a>
                            </h5>

                            <p class="fs-5 mb-1">Updated <a class="text-uppercase" href="javascript:;"><i
                                  class="bi-journal-bookmark-fill"></i> Fr-3</a> as <span
                                class="badge bg-soft-secondary text-secondary rounded-pill"><span
                                  class="legend-indicator bg-secondary"></span>"To do"</span></p>

                            <span class="text-muted small text-uppercase">Feb 10</span>
                          </div>
                        </div>
                      </li>
                      <!-- End Step Item -->
                    </ul>
                    <!-- End Step -->
                  </div>
                  <!-- End Body -->

                  <!-- Footer -->
                  <div class="card-footer">
                    <a class="link link-collapse" data-bs-toggle="collapse" href="#collapseActivitySection"
                      role="button" aria-expanded="false" aria-controls="collapseActivitySection">
                      <span class="link-collapse-default">View more</span>
                      <span class="link-collapse-active">View less</span>
                    </a>
                  </div>
                  <!-- End Footer -->
                </div>
                <!-- End Card -->
              </div>

              <!-- Sticky Block End Point -->
              <div id="stickyBlockEndPoint"></div>
            </div>
          </div>
          <!-- End Row -->
        </div>

        <div class="tab-pane fade" id="savings" role="tabpanel" aria-labelledby="savings-tab">
          <div class="row">
            <!-- <div class="col-lg-4 mb-3 mb-lg-0">
              <h4>Savings</h4>
            </div> -->

            <div class="col-lg-12">
              <!-- Card -->
              <div class="card" *ngIf="customer">
                <!-- Body -->
                <div class="card-body">
                  <form [formGroup]="savingsForm">
                    <div class="row">
                      <div class="col-sm-6">
                        <!-- Form -->
                        <div class="mb-4">
                          <label for="firstNameSavings" class="form-label">First name</label>
                          <input type="text" class="form-control" formControlName="firstname" readonly
                            id="firstNameSavings" value="{{customer?.firstName}}">
                        </div>
                        <!-- End Form -->
                      </div>
                      <!-- End Col -->

                      <div class="col-sm-6">
                        <!-- Form -->
                        <div class="mb-4">
                          <label for="lastNameSavings" class="form-label">Last name</label>
                          <input type="text" class="form-control" formControlName="lastname" readonly
                            id="lastNameSavings" value="{{customer?.lastName}}">
                        </div>
                        <!-- End Form -->
                      </div>
                      <!-- End Col -->
                    </div>
                    <!-- End Row -->

                    <div class="row">
                      <div class="col-sm-6">

                        <!-- Form -->
                        <div class="mb-4">
                          <label for="accountNoSavings" class="form-label">Account Number</label>
                          <input type="number" class="form-control" formControlName="account_num" readonly
                            id="accountNoSavings" value="{{customer?.account_num}}">
                        </div>
                        <!-- End Form -->
                      </div>
                      <!-- End Col -->

                      <div class="col-sm-6">
                        <!-- Form -->
                        <div class="mb-4">
                          <label for="planSavings" class="form-label">Subscribed Plan</label>
                          <!-- Select -->
                          <div class="tom-select-custom mb-3">
                            <select class="js-select form-select" id="planSavings" formControlName="planId"
                              data-hs-tom-select-options='{
                            "placeholder": "Select plan"
                          }'>
                              <option [value]="changeNumber(plan.plan_id)"
                                *ngFor="let plan of userPlans; let i = index;"
                                attr.data-option-template='<span class="d-flex align-items-center">
                              <span class="text-truncate">{{plan.plan_name.concat(" - ").concat((plan.plan_amount | currency: "₦"))}}</span></span>'>
                                {{plan.plan_name}} - {{plan.plan_amount | currency: '₦'}}
                              </option>
                            </select>
                          </div>
                          <!-- End Select -->
                        </div>
                        <!-- End Form -->
                      </div>
                      <!-- End Col -->

                    </div>
                    <!-- End row -->

                    <!-- Form -->
                    <div class="mb-4">
                      <label for="amountSavings" class="form-label">Amount</label>
                      <input type="number" class="form-control" formControlName="transAmount" id="amountSavings"
                        value="{{0 | currency: ''}}">
                    </div>
                    <!-- End Form -->


                    <!-- Form Check -->
                    <div class="form-check mb-4">
                      <input class="form-check-input" type="checkbox" formControlName="terms" id="termsCheckbox">
                      <label class="form-check-label" for="termsCheckbox">I have the consent of the customer
                        to perform this transaction.</label>
                    </div>
                    <!-- End Form Check -->

                    <div class="d-flex justify-content-end gap-3">
                      <button type="button" class="btn btn-white">Reset</button>
                      <button type="button" class="btn btn-primary"
                        (click)="enterPin(pin, savingsForm.value)">Submit</button>
                    </div>
                  </form>

                </div>
                <!-- Body -->

              </div>
              <!-- End Card -->
            </div>
          </div>
          <!-- End Row -->
        </div>

        <div class="tab-pane fade" id="withdrawal" role="tabpanel" aria-labelledby="withdrawal-tab">
          <div class="row">
            <!-- <div class="col-lg-4 mb-3 mb-lg-0">
              <h4>Savings</h4>
            </div> -->

            <div class="col-lg-12">
              <!-- Card -->
              <div class="card" *ngIf="customer != null">
                <!-- Body -->
                <div class="card-body">
                  <form [formGroup]="withdrawalForm">

                    <!-- Form Switch -->
                    <div class="mb-4">
                    <label class="row form-check form-switch" for="switch2">
                      <span class="col-8 col-sm-9 ms-0">
                          <span class="text-dark">Withdraw to bank <i class="bi-question-circle text-body ms-1"
                                  data-bs-toggle="tooltip" data-bs-placement="top"
                                  title="Transfer money from Moloyal account to customer bank account"></i></span>
                      </span>
                      <span class="col-4 col-sm-3 text-end">
                          <input type="checkbox" class="form-check-input" (change)="switchWithdrawType()" formControlName="bankWithdrawal" id="switch2">
                      </span>
                  </label>
                </div>
                  <!-- End Form Switch -->

                    <div class="row">
                      <div class="col-sm-6">
                        <!-- Form -->
                        <div class="mb-4">
                          <label for="firstNameLabel" class="form-label">First name</label>
                          <input type="text" class="form-control" formControlName="firstname" readonly
                            id="firstNameLabel" value="{{customer?.firstName}}">
                        </div>
                        <!-- End Form -->
                      </div>
                      <!-- End Col -->

                      <div class="col-sm-6">
                        <!-- Form -->
                        <div class="mb-4">
                          <label for="lastNameLabel" class="form-label">Last name</label>
                          <input type="text" class="form-control" formControlName="lastname" readonly id="lastNameLabel"
                            value="{{customer?.lastName}}">
                        </div>
                        <!-- End Form -->
                      </div>
                      <!-- End Col -->
                    </div>
                    <!-- End Row -->

                    <div class="row">
                      <div class="col-sm-6">

                        <!-- Form -->
                        <div class="mb-4">
                          <label for="accountNoLabel" class="form-label">Account Number</label>
                          <input type="number" class="form-control" formControlName="account_num" readonly
                            id="accountNoLabel" value="{{customer?.account_num}}">
                        </div>
                        <!-- End Form -->
                      </div>
                      <!-- End Col -->

                      <div class="col-sm-6">
                        <!-- Form -->
                        <div class="mb-4">
                          <label for="planLabel" class="form-label">Subscribed Plan</label>
                          <!-- Select -->
                          <div class="tom-select-custom mb-3">
                            <select class="js-select form-select" id="planLabel" formControlName="planId"
                              data-hs-tom-select-options='{
                            "placeholder": "Select plan"
                          }'>
                              <option value="{{plan.plan_id}}" *ngFor="let plan of userPlans; let i = index;"
                                attr.data-option-template='<span class="d-flex align-items-center">
                              <span class="text-truncate">{{plan.plan_name.concat(" - ").concat((plan.plan_amount | currency: "₦"))}}</span></span>'>
                                {{plan.plan_name.concat(" - ").concat((plan.plan_amount | currency: "₦"))}}
                              </option>
                            </select>
                          </div>
                          <!-- End Select -->
                        </div>
                        <!-- End Form -->
                      </div>
                      <!-- End Col -->

                      
                    </div>

                    <div class="row" *ngIf="bankWithdrawal == true" formGroupName="bank">
                      <div class="col-sm-6">
                        <div class="mb-4">
                          <label for="bankLabel" class="form-label">Bank <i class="bi-question-circle text-body ms-1"
                              data-bs-toggle="tooltip" data-bs-placement="top"
                              title="Select the bank to transfer to?"></i></label>
  
                          <!-- Select -->
                          <div class="tom-select-custom">
                              <select class="js-select form-select" autocomplete="off" id="bankLabel" formControlName="bank_code"
                                  data-hs-tom-select-options='{
                            "placeholder": "Select Bank"
                          }'>
                                  <option *ngFor="let b of allBanks; let i = index;" [value]="b?.code">{{b?.name}}</option>
                              </select>
                          </div>
                          <!-- End Select -->
                      </div>
                      <!-- End Form -->
                      </div>

                      <div class="col-sm-6">
                        <div class="mb-4">
                          <label for="accountNoLabel" class="form-label">Account Number</label>
                          <input type="text" class="form-control" (keyup)="verifyAccount($event)" formControlName="account_number" id="accountNoLabel">
                        <small [ngClass]="error == true ? 'text-danger' : 'form-text' " *ngIf="verifiedAcctName">{{verifiedAcctName}}</small>
                        </div>
                        <!-- End Form -->

                      </div>
                    </div>

                    <!-- Form -->
                    <div class="mb-4">
                      <label for="amountLabel" class="form-label">Amount</label>
                      <input type="number" class="form-control" formControlName="transAmount" id="amountLabel"
                        value="{{0 | currency: ''}}">
                    </div>
                    <!-- End Form -->





                    <!-- Form Check -->
                    <div class="form-check mb-4">
                      <input class="form-check-input" type="checkbox" formControlName="terms" id="termsCheckbox2">
                      <label class="form-check-label" for="termsCheckbox2">I have the consent of the customer
                        to perform this transaction.</label>
                    </div>
                    <!-- End Form Check -->

                    <div class="d-flex justify-content-end gap-3">
                      <button type="button" class="btn btn-white">Reset</button>
                      <button type="button" class="btn btn-primary" *ngIf="user.level=== '1' || user.level=== '2' "
                        [disabled]="!withdrawalForm.valid" (click)="enterPin(pin, withdrawalForm.value)">Submit</button>
                      <button type="button" class="btn btn-primary" *ngIf="user.level=== '3' || user.level=== '4' "
                        [disabled]="!withdrawalForm.valid || loading" (click)="Withdrawal('1111')">Submit
                        <div class="spinner-border spinner-border-sm text-light" role="status" *ngIf="loading">
                          <span class="visually-hidden">Loading...</span>
                        </div>
                      </button>
                    </div>
                  </form>

                </div>
                <!-- Body -->

              </div>
              <!-- End Card -->
            </div>
          </div>
          <!-- End Row -->

        </div>

        <div class="tab-pane fade" id="transactions-history" role="tabpanel" aria-labelledby="transactions-history-tab">
          <div class="row">
            <div class="col-lg-12">
              <!-- Card -->
              <div class="card">
                <!-- Header -->
                <div class="card-header d-flex gap-2">
                  <h4 class="card-header-title">Last 20 Transactions</h4>

                  <div class="ms-auto">
                    <a [routerLink]="['/customer', customer?.sn, 'trans-history']" class="btn btn-light">View All
                      Transactions</a>
                  </div>
                </div>
                <!-- End Header -->

                <!-- Table -->
                <div class="table-responsive position-relative">
                  <table class="table table-borderless table-thead-bordered table-nowrap table-align-middle card-table">
                    <thead class="thead-light">
                      <tr>
                        <th>T. Reference</th>
                        <th>T. Type</th>
                        <th>Amount</th>
                        <th>Date</th>
                        <th>Receipt</th>
                        <th>View</th>
                      </tr>
                    </thead>

                    <tbody>
                      <ng-container *ngIf="customerTrxs != undefined && customerTrxs.length > 0 else elseTemplate">                      
                      <tr *ngFor="let t of customerTrxs; let i = index;">
                        <td><a type="button" (click)="open(content, t)">{{t?.transref}}</a></td>
                        <td>
                          <span class="badge bg-soft-success text-success"
                            *ngIf="t?.transType === 'Savings' ">{{t?.transType | titlecase}}</span>
                          <span class="badge bg-soft-danger text-danger"
                            *ngIf="t?.transType === 'Withdrawal' ">{{t?.transType | titlecase}}</span>
                          <span class="badge bg-soft-warning text-warning"
                            *ngIf="t?.transType === 'commission' ">{{t?.transType | titlecase}}</span>
                        </td>
                        <td>{{t?.transAmount | currency: '₦' }}</td>
                        <td>{{t?.transDate | date}}</td>
                        <td>
                          <button class="btn btn-white btn-sm" (click)="openReceipt(t)">
                            <i class="bi-file-earmark-arrow-down-fill me-1"></i>View Receipt
                          </button>
                        </td>
                        <td>
                          <button class="btn btn-white btn-sm" (click)="open(content, t)"><i
                              class="bi-eye-fill me-1"></i> Quick view</button>
                        </td>
                      </tr>
                    </ng-container>
                      <ng-template #elseTemplate>
                        <tr>
                          <td valign="top" colspan="8" class="dataTables_empty">
                            <div class="text-center p-4">
                              <img class="mb-3" src="{{emptyTable}}" alt="Image Description" style="width: 10rem;"
                                data-hs-theme-appearance="default">
                              <p class="mb-0">No transaction history found</p>
                            </div>
                          </td>
                        </tr>
                      </ng-template>

                    </tbody>
                  </table>
                </div>
                <!-- End Table -->
              </div>
              <!-- End Card -->
            </div>
          </div>

        </div>

        <div class="tab-pane fade" id="plans" role="tabpanel" aria-labelledby="plans-tab">
          <form [formGroup]="PlanForm" (ngSubmit)="createPlan()" *ngIf="plans?.length > 0">
            <div class="row">
              <div class="col-md-3 mb-3" *ngFor="let plan of plans; let i = index;">
                <!-- Card -->
                <div class="card card-lg form-check form-check-select-stretched h-100 zi-1">
                  <div class="card-header text-center p-3">
                    <!-- Form Check -->
                    <input type="radio" class="form-check-input" formControlName="plans" id="plan_id{{plan?.sn}}"
                      checked value="{{plan?.sn}}">
                    <label class="form-check-label" for="plan_id{{plan?.sn}}"></label>
                    <!-- End Form Check -->

                    <span class="card-subtitle">{{plan?.plan_name}}</span>
                    <h2 class="card-title text-dark"><span id="planCount1" class="display-5">{{checkNumber(plan?.amount)
                        == "number" ? (plan.amount | currency: '₦') : plan.amount}}</span>
                      <span class="fs-6 text-muted">/ month</span>
                    </h2>
                  </div>

                  <div class="card-body d-flex justify-content-center p-3">
                    <!-- List Checked -->
                    <ul class="list-checked list-checked-primary mb-0">
                      <li class="list-checked-item">Duration: {{plan?.plan_duration}}</li>
                      <li class="list-checked-item">Days: {{plan?.days}}</li>
                      <li class="list-checked-item">Commission: {{plan?.commission}}</li>
                      <li class="list-checked-item">Withdraw at any time</li>
                    </ul>
                    <!-- End List Checked -->
                  </div>

                </div>
                <!-- End Card -->
              </div>
              <!-- End Col -->
            </div>
            <!-- End Row -->

            <div class="text-center">
              <div class="d-grid mb-2">
                <button type="submit" class="btn btn-primary" [disabled]="loading">Select Plan
                  <div class="spinner-border spinner-border-sm text-light" role="status" *ngIf="loading">
                    <span class="visually-hidden">Loading...</span>
                  </div>
                </button>
              </div>
            </div>
          </form>

          <div class="row" *ngIf="plansInfo!= null && plans?.length == 0">
            <div class="text-center p-4">
              <img class="mb-3" src="{{emptyTable}}" alt="Image Description" style="width: 10rem;"
                data-hs-theme-appearance="default">
              <p class="mb-0">{{plansInfo}}</p>
            </div>
          </div>

        </div>

        <div class="tab-pane fade" id="updateProfile" role="tabpanel" aria-labelledby="updateProfile-tab">
          <div class="row">
            <!-- <div class="col-lg-4 mb-3 mb-lg-0">
              <h4>Savings</h4>
            </div> -->

            <div class="col-lg-12">
              <!-- Card -->
              <div class="card" *ngIf="customer">
                <!-- Body -->
                <div class="card-body">
                  <form [formGroup]="updateProfileForm" (ngSubmit)="updateUser()">
                    <div class="row">
                      <div class="col-sm-4">
                        <!-- Form -->
                        <div class="mb-4">
                          <label for="firstNameProfile" class="form-label">First name</label>
                          <input type="text" class="form-control" formControlName="firstName"
                            id="firstNameProfile" [readonly]="user?.level == 3 || user?.level == 4 ? false : true" >
                        </div>
                        <!-- End Form -->
                      </div>
                      <!-- End Col -->

                      <div class="col-sm-4">
                        <!-- Form -->
                        <div class="mb-4">
                          <label for="middleNameProfile" class="form-label">Middle name</label>
                          <input type="text" class="form-control" formControlName="mname"
                            id="middleNameProfile" [readonly]="user?.level == 3 || user?.level == 4 ? false : true">
                        </div>
                        <!-- End Form -->
                      </div>
                      <!-- End Col -->

                      <div class="col-sm-4">
                        <!-- Form -->
                        <div class="mb-4">
                          <label for="lastNameProfile" class="form-label">Last name</label>
                          <input type="text" class="form-control" formControlName="lastName"
                            id="lastNameProfile" [readonly]="user?.level == 3 || user?.level == 4 ? false : true">
                        </div>
                        <!-- End Form -->
                      </div>
                      <!-- End Col -->
                    </div>
                    <!-- End Row -->

                    <div class="row">                    

                      <div class="col-sm-4">
                        <!-- Form -->
                        <div class="mb-4">
                          <label for="emailProfile" class="form-label">Email Address</label>
                          <input type="text" class="form-control" formControlName="email" id="emailProfile" value="{{customer?.lastName}}" 
                          [readonly]="user?.level == 3 || user?.level == 4 ? false : true">
                        </div>
                        <!-- End Form -->
                      </div>
                      <!-- End Col -->

                      <div class="col-sm-4">
                        <!-- Form -->
                        <div class="mb-4">
                          <label for="phoneProfile" class="form-label">Phone Number</label>
                          <input type="text" class="form-control" formControlName="userId"
                            id="phoneProfile" [readonly]="user?.level == 3 || user?.level == 4 ? false : true">
                        </div>
                        <!-- End Form -->
                      </div>
                      <!-- End Col -->

                      <div class="col-sm-4">
                        <!-- Form -->
                        <div class="mb-4">
                          <label for="networkProfile" class="form-label">Mobile Network</label>
                          <!-- Select -->
                          <div class="tom-select-custom mb-3">
                            <select class="js-select form-select" id="networkProfile" formControlName="mobilenetwork"
                              data-hs-tom-select-options='{
                            "placeholder": "Select Mobile Network"
                          }'>
                              <option [value]="network?.name"
                                *ngFor="let network of networks; let i = index;"
                                attr.data-option-template='<span class="d-flex align-items-center">
                              <span class="text-truncate">{{network?.name}}</span></span>'>
                                {{network?.name}}
                              </option>
                            </select>
                          </div>
                          <!-- End Select -->
                        </div>
                        <!-- End Form -->
                      </div>
                      <!-- End Col -->

                    </div>
                    <!-- End row -->

                    <div class="row">
                      <div class="col-sm-4">
                        <!-- Form -->
                        <div class="mb-4">
                          <label for="BVN_numProfile" class="form-label">BVN</label>
                          <input type="number" class="form-control" formControlName="BVN_num" id="BVN_numProfile">
                        </div>
                        <!-- End Form -->                    
                      </div>

                      <div class="col-sm-4">
                        <!-- Form -->
                        <div class="mb-4">
                          <label for="dateOfBirthProfile" class="form-label">Date of Birth</label>
                          <input type="date" class="form-control" formControlName="dateOfBirth" id="dateOfBirthProfile">
                        </div>
                        <!-- End Form -->                    
                      </div>

                      <div class="col-sm-4">
                        <!-- Form -->
                        <div class="mb-4">
                          <label for="genderProfile" class="form-label">Gender</label>
                          <!-- Select -->
                          <div class="tom-select-custom mb-3">
                            <select class="js-select form-select" id="genderProfile" formControlName="gender"
                              data-hs-tom-select-options='{
                            "placeholder": "Select Gender"
                          }'>
                              <option [value]="gender?.name"
                                *ngFor="let gender of genders; let i = index;"
                                attr.data-option-template='<span class="d-flex align-items-center">
                              <span class="text-truncate">{{gender?.name}}</span></span>'>
                                {{gender?.name}}
                              </option>
                            </select>
                          </div>
                          <!-- End Select -->
                        </div>
                        <!-- End Form -->                    
                      </div>
                    
                    </div>

                    <div class="row">
                      <div class="col-sm-4">
                        <!-- Form -->
                        <div class="mb-4">
                          <label for="streetProfile" class="form-label">Street</label>
                          <input type="text" class="form-control" formControlName="street1" id="streetProfile">
                        </div>
                        <!-- End Form -->                    
                      </div>

                      <div class="col-sm-4">
                        <!-- Form -->
                        <div class="mb-4">
                          <label for="cityProfile" class="form-label">City</label>
                          <input type="text" class="form-control" formControlName="city" id="cityProfile">
                        </div>
                        <!-- End Form -->                    
                      </div>

                      <div class="col-sm-4">
                        <!-- Form -->
                        <div class="mb-4">
                          <label for="stateProfile" class="form-label">State</label>
                          <input type="text" class="form-control" formControlName="state" id="stateProfile">
                        </div>
                        <!-- End Form -->                    
                      </div>
                    
                    </div>


                    <!-- Form Check -->
                    <div class="form-check mb-4">
                      <input class="form-check-input" type="checkbox" formControlName="terms" id="termsCheckboxProfile">
                      <label class="form-check-label" for="termsCheckboxProfile">I have the consent of the customer
                        to perform this transaction.</label>
                    </div>
                    <!-- End Form Check -->

                    <div class="d-flex justify-content-end gap-3">
                      <button type="reset" class="btn btn-white">Reset</button>                      
                      <button type="submit" class="btn btn-primary" [disabled]="loading">Update Profile
                        <div class="spinner-border spinner-border-sm text-light" role="status" *ngIf="loading">
                          <span class="visually-hidden">Loading...</span>
                        </div>
                      </button>
                    </div>
                  </form>

                </div>
                <!-- Body -->

              </div>
              <!-- End Card -->
            </div>
          </div>
          <!-- End Row -->
        </div>

      </div>

    </div>
    <!-- End Col -->
  </div>
  <!-- End Row -->
</div>
<!-- End Content -->

<!-- ng-template receipt -->
<ng-template #content let-modal>
  <app-receipt [customerId]="modalContent?.customerId"
    [fullName]="(modalContent.firstName?.concat(' ').concat(modalContent?.lastName))"
    [firstName]="modalContent?.firstName" [lastName]="modalContent?.lastName"
    [transDate]="(modalContent.transDate?.concat(' ').concat(modalContent?.time))" [transType]="modalContent?.transType"
    [transref]="modalContent?.transref" [transAmount]="modalContent?.transAmount" [accountNo]="modalContent?.accountNo"
    [userId]="modalContent?.userId" [planName]="modalContent?.plan_name" (onOpenPdfContent)="openReceipt(modalContent)"
    (onPrintPdfContent)="printReceipt(modalContent)" (onModalClose)="modal.dismiss('Cross click')"></app-receipt>
</ng-template>

<ng-template #pin let-modal>
  <app-pin [loading]="loading" [config]="config" (onSubmit)="performTransaction(transactionValues, otp)"
    (onModalClose)="modal.dismiss('Cross click')" (onPinChange)="onOtpChange($event)" [otp]="otp" [data]="data"
    [showOtpComponent]="showOtpComponent" [otpLength]="otpLength"></app-pin>

</ng-template>